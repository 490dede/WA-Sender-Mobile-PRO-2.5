<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen CS - WA-Sender PRO 2.5</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #F8FAFC; }
        .input-field { background: #F8FAFC; border: 1px solid #F1F5F9; border-radius: 1.25rem; padding: 1rem; font-weight: 700; outline: none; width: 100%; }
    </style>
</head>
<body class="p-6 md:p-12">
    <div class="max-w-4xl mx-auto space-y-8">
        <header class="flex items-center gap-4 bg-white p-8 rounded-[2.5rem] shadow-sm">
            <a href="dashboard-user.html" class="w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center text-xl hover:bg-slate-900 hover:text-white transition-all">â¬…</a>
            <h1 class="text-2xl font-black italic">Pasukan CS</h1>
        </header>

        <section class="bg-white p-10 rounded-[3rem] shadow-sm">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <input type="text" id="csUser" placeholder="Username CS" class="input-field">
                <input type="email" id="csEmail" placeholder="Email CS" class="input-field">
                <input type="text" id="csWA" placeholder="WA CS (62...)" class="input-field">
                <input type="password" id="csPass" placeholder="Password CS" class="input-field">
            </div>
            <button onclick="registerCS()" id="btnReg" class="mt-8 px-10 py-5 bg-indigo-600 text-white rounded-[1.5rem] font-black uppercase text-[10px] tracking-widest shadow-xl shadow-indigo-100 active:scale-95 transition-all">Daftarkan Pasukan CS</button>
        </section>

        <div id="csGrid" class="grid grid-cols-1 gap-4"></div>
    </div>

    <script>
        const SB_URL = "https://xitvmryrzeiinlcgdrfj.supabase.co";
        const SB_KEY = "sb_publishable_DLbeS1UUi5tjY51yRy6VkA_unJMJFbk";
        const supabase = window.supabase.createClient(SB_URL, SB_KEY);

        async function registerCS() {
            const btn = document.getElementById('btnReg');
            const { data: { session } } = await supabase.auth.getSession();
            const email = document.getElementById('csEmail').value;
            const pass = document.getElementById('csPass').value;

            btn.disabled = true;
            btn.innerText = "Mendaftarkan...";

            const { data: authData, error: authError } = await supabase.auth.signUp({ email, password: pass });
            if(authError) { alert(authError.message); btn.disabled = false; return; }

            const { error: profError } = await supabase.from('profiles').insert([{
                id: authData.user.id,
                username: document.getElementById('csUser').value,
                email: email,
                whatsapp_number: document.getElementById('csWA').value,
                role: 'CS',
                package_type: 'TEAM',
                added_by: session.user.id
            }]);

            if(!profError) { alert("CS Berhasil!"); location.reload(); }
        }

        async function loadCS() {
            const { data: { session } } = await supabase.auth.getSession();
            const { data: list } = await supabase.from('profiles').select('*').eq('added_by', session.user.id);
            const grid = document.getElementById('csGrid');
            grid.innerHTML = list.map(cs => `<div class="p-6 bg-white rounded-2xl border border-slate-100 font-bold">${cs.username} (${cs.email})</div>`).join('');
        }
        loadCS();
    </script>
</body>
</html>
